Z80ASM SuperFast Relocating Macro Assembler     	    Z80ASM 1.32 Page   1
BCD2BN  Z80

    1                   ;
    2                   ;
    3                   ;
    4                   ;
    5                   ;       Title           BCD to binary coversion
    6                   ;       Name:           BCD2BN
    7                   ;
    8                   ;
    9                   ;       Purpose:        Convert one byte of BCD data to one
   10                   ;			byte of binary data
   11                   ;
   12                   ;	Entry:		Register A = BCD data
   13                   ;
   14                   ;	Exit:		Register A = Binary data
   15                   ;
   16                   ;	Registers used:	A, B, C, F
   17                   ;
   18                   ;	Time:		60 cycles
   19                   ;
   20                   ;	Size:		Program 14 bytes
   21                   ;
   22                   ;
   23                   ;
   24                   
   25 0100              BCD2BN:
   26                   	;MULYIPLY UPPER NIBBLE BY 10 AND SAVE IT
   27                   	; UPPER NIBBLE * 10 = UPPER NIBBLE * (8 +2)
   28 0100  47          	LD	B,A		;SAVE ORIGINAL BCD VALUE IN B
   29 0101  E6 F0       	AND	0F0H		;MASK OFFUPPER NIBBLE
   30 0103  0F          	RRCA			;SHIFT RIGHT 1 BIT
   31 0104  4F          	LD	C,A		;C = UPPER NIBBLE * 8
   32 0105  0F          	RRCA			;SHIFT RIGHT 2 MORE TIMES
   33 0106  0F          	RRCA			;A = UPPER NIBBLE * 2
   34 0107  81          	ADD	A,C
   35 0108  4F          	LD	C,A 		;C = UPPER NIBBLE * (8+2)
   36                   
   37                   	;GET LOWER NIBBLE AND ADD IT TO THE
   38                   	; BINARY EQUIVALENT OF THE UPPER NIBBLE
   39 0109  78          	LD	A,B		;GET ORIGINAL VALUE BACK
   40 010A  E6 0F       	AND 	0FH		;MASK OFF UPPER NIBBLE
   41 010C  81          	ADD	A,C		;ADD TO BINARY UPPER NIBBLE
   42 010D  C9          	RET	
   43                   
   44                   ;
   45                   ;
   46                   ;	SAMPLE EXECUTION:
   47                   ;
   48                   ;
   49                   
   50 010E              SC4B:
   51                   	;CONVERT 0 BCD TO 0 HEXADECIMAL
   52 010E  3E 00       	LD	A,0
   53 0110  CD 0100     	CALL	BCD2BN		;A = 0H
   54                   
   55                   	;CONVERT 99 BCD TO 63 HEXADECIMAL
   56 0113  3E 99       	LD	A,099H
   57 0115  CD 0100     	CALL	BCD2BN		;A = 63H
   58                   
Z80ASM SuperFast Relocating Macro Assembler     	    Z80ASM 1.32 Page   2
BCD2BN  Z80

   59                   	;CONVERT 23 BCD TO 17 HEXADECIMAL
   60 0118  3E 23       	LD	A,23H
   61 011A  CD 0100     	CALL	BCD2BN		;A = 17H
   62                   
   63 011D  18 EF       	JR	SC4B
   64                   
   65                   	END
 0 Error(s) Detected.
 31 Absolute Bytes. 2 Symbols Detected.
Z80ASM SuperFast Relocating Macro Assembler     	    Z80ASM 1.32 Page   3
Symbol Table:

0100  BCD2BN           010E  SC4B
Z80ASM SuperFast Relocating Macro Assembler     	    Z80ASM 1.32 Page   4
Cross Reference:

0100  BCD2BN              25    53    57    61
010E  SC4B                50    63
D TO 0 HEXADECIMAL
   52 010E  3